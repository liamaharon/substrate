<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module allows for inspection and instrumentation, i.e. modifying the module to alter it’s structure or behavior, of a wasm module."><title>sc_executor_common::runtime_blob - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sc_executor_common" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.1 (eb26296b5 2023-08-03)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../sc_executor_common/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../sc_executor_common/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module runtime_blob</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">sc_executor_common</a>::<wbr><a class="mod" href="#">runtime_blob</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/sc_executor_common/runtime_blob/mod.rs.html#19-55">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module allows for inspection and instrumentation, i.e. modifying the module to alter it’s
structure or behavior, of a wasm module.</p>
<h3 id="instrumentation"><a href="#instrumentation">Instrumentation</a></h3>
<p>In ideal world, there would be no instrumentation. However, in the real world the execution
engines we use are somewhat limited in their APIs or abilities.</p>
<p>To give you some examples:</p>
<p>We need to reset the globals because when we
execute the Substrate Runtime, we do not drop and create the instance anew, instead
we restore some selected parts of the state.</p>
<ul>
<li>
<p>stack depth metering can be performed via instrumentation or deferred to the engine and say be
added directly in machine code. Implementing this in machine code is rather cumbersome so
instrumentation looks like a good solution.</p>
<p>Stack depth metering is needed to make a wasm blob
execution deterministic, which in turn is needed by the Parachain Validation Function in
Polkadot.</p>
</li>
</ul>
<h3 id="inspection"><a href="#inspection">Inspection</a></h3>
<p>Inspection of a wasm module may be needed to extract some useful information, such as to extract
data segment snapshot, which is helpful for quickly restoring the initial state of instances.
Inspection can be also useful to prove that a wasm module possesses some properties, such as,
is free of any floating point operations, which is a useful step towards making instances
produced from such a module deterministic.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.DataSegmentsSnapshot.html" title="struct sc_executor_common::runtime_blob::DataSegmentsSnapshot">DataSegmentsSnapshot</a></div><div class="desc docblock-short">This is a snapshot of data segments specialzied for a particular instantiation.</div></li><li><div class="item-name"><a class="struct" href="struct.ExposedMutableGlobalsSet.html" title="struct sc_executor_common::runtime_blob::ExposedMutableGlobalsSet">ExposedMutableGlobalsSet</a></div><div class="desc docblock-short">A set of exposed mutable globals.</div></li><li><div class="item-name"><a class="struct" href="struct.GlobalsSnapshot.html" title="struct sc_executor_common::runtime_blob::GlobalsSnapshot">GlobalsSnapshot</a></div><div class="desc docblock-short">A snapshot of a global variables values. This snapshot can be later used for restoring the
values to the preserved state.</div></li><li><div class="item-name"><a class="struct" href="struct.RuntimeBlob.html" title="struct sc_executor_common::runtime_blob::RuntimeBlob">RuntimeBlob</a></div><div class="desc docblock-short">A bunch of information collected from a WebAssembly module.</div></li></ul><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.InstanceGlobals.html" title="trait sc_executor_common::runtime_blob::InstanceGlobals">InstanceGlobals</a></div><div class="desc docblock-short">An adapter for a wasm module instance that is focused on getting and setting globals.</div></li></ul></section></div></main></body></html>